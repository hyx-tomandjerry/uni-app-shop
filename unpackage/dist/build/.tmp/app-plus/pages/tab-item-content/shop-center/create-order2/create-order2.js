(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab-item-content/shop-center/create-order2/create-order2"],{1202:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("df5e"));function n(e){return e&&e.__esModule?e:{default:e}}var o=s("c4e7"),a=function(){return s.e("components/uni/uni-icon/uni-icon").then(s.bind(null,"f177"))},i=function(){return s.e("components/uni/mx-datepicker/mx-datepicker").then(s.bind(null,"51fd"))},r={props:[],data:function(){return{showPicker:!1,value:"",index:-1,imgList:[],itemComponents:[],num:1,amapPlugin:null,key:"4c523fb1857f99ba7f2d683d9e88ec1e",shop:{name:"",address:"",id:""},designer:{name:"",telephone:"",date:""},repair:{subID:"",subName:"",bigName:"",summary:""},files:[],type:"rangetime"}},components:{uniIcon:a,MxDatePicker:i},getOpenDate:function(){var e=new Date;return this.format(e,"YMD")},onLoad:function(t){t&&(console.log(t," at pages\\tab-item-content\\shop-center\\create-order2\\create-order2.vue:234"),this.shop.id=t.shopID,this.shop.name=t.shopName,this.shop.address=t.shopAddress),this.$store.state.userInfo&&(this.designer.name=this.$store.state.userInfo.name,this.designer.telephone=this.$store.state.userInfo.mobile,e.setStorage({key:"name",data:this.$store.state.userInfo.name}),e.setStorage({key:"telephone",data:this.$store.state.userInfo.mobile}))},methods:{goBack:function(){e.navigateTo({url:"../shop-list/shop-list"})},inputTel:function(t){e.setStorage({key:"telephone",data:t.detail.value})},inputName:function(t){e.setStorage({key:"name",data:t.detail.value})},onSelected:function(t){this.showPicker=!1,t&&(this[this.type]=t.value,this.designer.date=t.value,e.setStorage({key:"time",data:t.value}))},onShowDatePicker:function(e){this.type=e,this.showPicker=!0,this.value=this[e]},getRegeoInfo:function(){var t=this;e.showLoading({title:"获取位置中..."}),this.amapPlugin.getRegeo({success:function(s){t.$store.commit("setProvince",s[0].regeocodeData.addressComponent.province),t.$store.commit("setAddress",s[0].regeocodeData.formatted_address),e.request({url:t.$store.state.url+"NearestShops",data:{owner:18,userId:49,address:"".concat(s[0].regeocodeData.addressComponent.province).concat(s[0].regeocodeData.formatted_address),size:8},success:function(e){t.shop.name=e.data.data[0].name,t.shop.address=e.data.data[0]["provinceName"]+e.data.data[0]["cityName"]+e.data.data[0]["districtName"],t.shop.id=e.data.data[0].id,console.log(t.shop," at pages\\tab-item-content\\shop-center\\create-order2\\create-order2.vue:309")}}),e.hideLoading()},fail:function(t){e.hideLoading()}})},showNearShopList:function(){e.navigateTo({url:"../near-shop-list/near-shop-list?shopAddress="+this.shop.address})},showRepairItem:function(){e.navigateTo({url:"../repair-item/repair-item"})},addRepairItem:function(){this.num++,this.itemComponents.push({})},ChooseImageEvent:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album"],success:function(s){0!=t.imgList.length?t.imgList=t.imgList.concat(s.tempFilePaths):t.imgList=s.tempFilePaths;for(var n={params:{owner:18,userId:49,"x:type":t.$store.state.constants.serviceorder_file}},a={useCdnDomain:!1},i=0;i<s.tempFilePaths.length;i++){var r=o.upload(s.tempFilePaths[i],"oaks"+s.tempFilePaths[i].split("/")+1e6*Math.random()+".jpg",t.token,n,a);r.subscribe(function(){},function(){},function(s){t.files.push(s.data),t.files.length===t.imgList.length&&e.showToast({title:"上传成功",icon:"success"})})}}})},ViewImage:function(t){e.previewImage({urls:this.imgList,current:t})},DelImg:function(t){var s=this;e.showModal({content:"确定删除？",cancelText:"取消",confirmText:"确定",success:function(n){n.confirm&&(s.imgList.splice(t,1),e.request({url:s.$store.state.url+"RemoveFiles",data:{id:s.files[t],owner:18,userId:49},success:function(n){s.files.splice(t,1),e.showToast({title:"删除成功",icon:"none"})}}))}})},textareaAInput:function(e){this.textareaAValue=e.detail.value},delComponent:function(e){console.log(e," at pages\\tab-item-content\\shop-center\\create-order2\\create-order2.vue:430"),this.itemComponents.splice(e,1),this.num>1&&this.num--},delRepairItem:function(e){this.itemComponents.splice(e,1)},createOrder:function(){var t="";this.files.length>0&&(t=this.files.join(",")),console.log(this.designer.date," at pages\\tab-item-content\\shop-center\\create-order2\\create-order2.vue:446"),this.repair.subID?this.repair.summary?e.request({url:this.$store.state.url+"NewServiceOrder",data:{owner:18,userId:49,catalog:this.repair.subID,creator:49,shop:65,appointdate:this.designer.date?this.designer.date:this.getOpenDate,summary:this.repair.summary,files:t,contractor:this.designer.name?this.designer.name:this.$store.state.userInfo.name,telephone:this.designer.telephone?this.designer.telephone:this.$store.state.userInfo.mobile},success:function(t){e.showToast({title:"新增报修成功",icon:"success"}),setTimeout(function(){e.navigateTo({url:"../shop-center"}),e.clearStorage()},500)}}):e.showToast({title:"请输入报修描述",icon:"none"}):e.showToast({title:"请选择报修类别",icon:"none"})},getUploadToken:function(){var t=this;e.request({url:this.$store.state.url+"UploadToken",success:function(e){t.token=e.data.data}})}}};t.default=r}).call(this,s("6e42")["default"])},"1be9":function(e,t,s){"use strict";s.r(t);var n=s("4f27"),o=s("d5ed");for(var a in o)"default"!==a&&function(e){s.d(t,e,function(){return o[e]})}(a);s("f6b2");var i=s("2877"),r=Object(i["a"])(o["default"],n["a"],n["b"],!1,null,null,null);t["default"]=r.exports},"4bd8":function(e,t,s){},"4f27":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},o=[];s.d(t,"a",function(){return n}),s.d(t,"b",function(){return o})},d5ed:function(e,t,s){"use strict";s.r(t);var n=s("1202"),o=s.n(n);for(var a in n)"default"!==a&&function(e){s.d(t,e,function(){return n[e]})}(a);t["default"]=o.a},f6b2:function(e,t,s){"use strict";var n=s("4bd8"),o=s.n(n);o.a}},[["f427","common/runtime","common/vendor"]]]);