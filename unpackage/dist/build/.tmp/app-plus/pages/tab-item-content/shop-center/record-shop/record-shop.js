(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab-item-content/shop-center/record-shop/record-shop"],{"02a0":function(t,e,o){"use strict";o.r(e);var a=o("434b"),n=o.n(a);for(var i in a)"default"!==i&&function(t){o.d(e,t,function(){return a[t]})}(i);e["default"]=n.a},"434b":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(){return o.e("components/jm-address/jm-address").then(o.bind(null,"0d97"))},n=(o("c4e7"),function(){return o.e("components/uni/mx-datepicker/mx-datepicker").then(o.bind(null,"51fd"))}),i={components:{addressed:a,MxDatePicker:n},data:function(){return{isShow:!1,provinceDataList:[],cityDataList:[],areaDataList:[],shop:{province:"",city:"",area:"",name:"",address:"",openDate:"",summary:"",contractor:"",telephone:"",coverID:""},category:{id:"",name:""},index:-1,imgList:[],coverList:[],cityLobal:"",titleValue:"",catalogList:[],type:"rangetime",showPicker:!1,value:"",openType:"",token:"",files:[]}},computed:{getOpenDate:function(){var t=new Date;return this.format(t,"YMD")}},onLoad:function(e){var o=this;this.getProvinceData(),this.getUploadToken(),t.getStorage({key:"userInfo",success:function(t){console.log(t.data," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:189"),o.shop.contractor=t.data.name,o.shop.telephone=t.data.account}}),e&&e.subID?this.category={id:e.subID,name:e.subName}:e&&e.bigID&&!e.subID&&(this.category={id:e.bigID,name:e.bigName}),this.$fire.on("category",function(t){o.category.name=t.name,o.category.id=t.id})},methods:{uploadCover:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(o){var a=o.tempFilePaths;e.coverList=o.tempFilePaths,t.getStorage({key:"userInfo",success:function(o){var n=t.uploadFile({url:e.$store.state.uploadHostUrl+e.token,filePath:a[0],name:"file",formData:{"x:type":26,"x:owner":o.data.owner,"x:creator":o.data.id},success:function(t){var o=JSON.parse(t.data);e.shop.coverID=o.data,console.log(e.shop.coverID," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:240")}});n.onProgressUpdate(function(e){100==e.progress&&t.showToast({title:"上传成功",icon:"none"})},function(e){t.showToast({title:"上传失败",icon:"none"})})}})}})},childClick:function(t){console.log(t," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:266"),this.shop.province=t.provinceID,this.shop.city=t.cityID,this.shop.district=t.districtID},hideModal:function(){this.isShow=!1,this.cityLobal=this.province.name+"-"+this.city.name+"-"+this.area.name},areaChange:function(){var t=this,e=document.getElementById("city").value;this.areaDataList.forEach(function(o){o.id==e&&(t.area=o)})},cityChange:function(){var t=this,e=document.getElementById("city").value;this.$ajax("Districts",{parent:e},function(o){t.areaDataList=o,t.area=t.areaDataList[0],t.cityDataList.forEach(function(o){o.id==e&&(t.city=o,console.log(o.name," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:293"))})})},provinceChange:function(){var t=this,e=document.getElementById("province").value;this.$ajax("Districts",{parent:e},function(o){t.cityDataList=o.data.data,t.city=t.cityDataList[0],t.provinceDataList.forEach(function(o){o.id==e&&(t.province=o)})})},checkTelEvent:function(e){console.log(e," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:432"),e&&/^[1][3,4,5,7,8][0-9]{9}$/.test(e)&&t.showToast({title:"电话号码不存在",icon:"none"})},showShopCatalog:function(){t.navigateTo({url:"../category-item/category-item"})},getCatalog:function(){var t=this;this.$ajax("Constants",{type:this.$store.state.constants.repair_type,parent:-1,objects:1},function(e){t.catalogList=e})},onSelected:function(t){this.showPicker=!1,t&&(this[this.type]=t.value,this.shop.openDate=t.value.replace(/\//g,"-"))},onShowDatePicker:function(t){this.type=t,this.showPicker=!0,this.value=this[t]},showMulLinkageThreePicker:function(){this.isShow=!0},recordShop:function(){var e=this;t.getStorage({key:"userInfo",success:function(o){e.category.id&&e.shop.name&&e.shop.province&&e.shop.address?e.$ajax("NewProprietorShop",{manager:o.data.id,brand:e.category.id,name:e.shop.name,area:e.shop.area,address:e.shop.address,duedate:e.shop.openDate?e.shop.openDate:e.getOpenDate,summary:e.shop.summary?e.shop.summary:"",province:e.shop.province,city:e.shop.city,district:e.shop.district,coverurl:e.shop.coverID,status:3,type:2},function(o){t.showToast({title:"录入门店成功",icon:"none"}),setTimeout(function(){t.navigateBack({delta:1,success:function(t){e.$fire.fire("record-shop")}})},500)}):t.showToast({title:"请填写完整信息",icon:"none"})}})},getProvinceData:function(){var t=this;this.$ajax("Districts",{parent:0},function(e){t.provinceDataList=e,t.province=t.provinceDataList[0]})},goBack:function(){t.navigateBack({delta:1})},chooseImageEvent:function(){var e=this;t.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album"],success:function(o){var a=o.tempFilePaths;0!=e.imgList.length?e.imgList=e.imgList.concat(o.tempFilePaths):e.imgList=o.tempFilePaths,t.getStorage({key:"userInfo",success:function(n){for(var i=0;i<o.tempFilePaths.length;i++){var s=t.uploadFile({url:e.$store.state.uploadHostUrl+e.token,filePath:a[i],name:"file",formData:{"x:type":26,"x:owner":n.data.owner,"x:creator":n.data.id},success:function(t){var o=JSON.parse(t.data);e.files.push(o.data)}});s.onProgressUpdate(function(e){100==e.progress&&t.showToast({title:"上传成功",icon:"none"})},function(e){t.showToast({title:"上传失败",icon:"none"})})}}})}})},ViewImage:function(e,o){"cover"==o?t.previewImage({urls:this.coverList,current:2}):"file"==o&&t.previewImage({urls:this.imgList,current:e})},DelImg:function(e,o){var a=this;t.showModal({content:"确定删除？",cancelText:"取消",confirmText:"确定",success:function(n){n.confirm&&("cover"==o?(a.coverList.splice(e,1),a.$ajax("RemoveFiles",{id:a.files[e]},function(o){a.files.splice(e,1),t.showToast({title:"删除成功",icon:"none"})})):"file"==o&&(a.imgList.splice(e,1),a.$ajax("RemoveFiles",{id:a.files[e]},function(o){a.files.splice(e,1),t.showToast({title:"删除成功",icon:"none"})})))}})},getUploadToken:function(){var t=this;this.$ajax("UploadToken",{},function(e){t.token=e})}}};e.default=i}).call(this,o("6e42")["default"])},"46c3":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];o.d(e,"a",function(){return a}),o.d(e,"b",function(){return n})},"8b40":function(t,e,o){"use strict";o.r(e);var a=o("46c3"),n=o("02a0");for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);o("caa2");var s=o("2877"),c=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=c.exports},"8c2b":function(t,e,o){},caa2:function(t,e,o){"use strict";var a=o("8c2b"),n=o.n(a);n.a}},[["f9f7","common/runtime","common/vendor"]]]);