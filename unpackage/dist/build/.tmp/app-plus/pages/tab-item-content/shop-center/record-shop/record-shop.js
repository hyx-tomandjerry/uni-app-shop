(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab-item-content/shop-center/record-shop/record-shop"],{"02a0":function(e,t,s){"use strict";s.r(t);var o=s("434b"),i=s.n(o);for(var n in o)"default"!==n&&function(e){s.d(t,e,function(){return o[e]})}(n);t["default"]=i.a},"434b":function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(s("63e7"));function i(e){return e&&e.__esModule?e:{default:e}}var n=s("c4e7"),r=function(){return s.e("components/city/mpvue-picker/mpvuePicker").then(s.bind(null,"4f9b"))},a=function(){return Promise.all([s.e("common/vendor"),s.e("components/city/mpvue-citypicker/mpvueCityPicker")]).then(s.bind(null,"ab87"))},c=function(){return s.e("components/uni/mx-datepicker/mx-datepicker").then(s.bind(null,"51fd"))},u={components:{mpvuePicker:r,mpvueCityPicker:a,MxDatePicker:c},data:function(){return{shop:{name:"",address:"",openDate:"",area:"",summary:"",province:"",city:0,district:0,contractor:"",telephone:"",coverID:""},category:{id:"",name:""},index:-1,imgList:[],coverList:[],mulLinkageTwoPicker:o.default,cityPickerValueDefault:[0,0,1],cityLobal:"",themeColor:"#007AFF",mode:"",deepLength:1,pickerValueDefault:[0],pickerValueArray:[],shoplist:["喵喵喵","汪汪汪","哼唧哼唧"],titleValue:"",catalogList:[],provinceDate:[],cityData:[],districtData:[],type:"rangetime",showPicker:!1,value:"",openType:"",token:"",files:[]}},computed:{getOpenDate:function(){var e=new Date;return this.format(e,"YMD")}},onLoad:function(e){this.getProvince(),this.getUploadToken(),e&&e.subID?this.category={id:e.subID,name:e.subName}:e&&e.bigID&&!e.subID&&(this.category={id:e.bigID,name:e.bigName})},methods:{uploadCover:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(s){0!=t.coverList.length?t.coverList=t.coverList.concat(s.tempFilePaths):t.coverList=s.tempFilePaths;var o={params:{"x:owner":t.$store.state.userInfo.owner,"x:creator":t.$store.state.userInfo.id,"x:type":26}},i={useCdnDomain:!1},r=n.upload(s.tempFilePaths[0],"oaks-1"+s.tempFilePaths[0].split("/")[3]+1e5*Math.random()+".jpg",t.token,o,i);r.subscribe(function(){},function(){},function(s){-1!=s.data&&e.showToast({title:"上传成功",icon:"none"}),t.shop.coverID=s.data,console.log(s.data," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:239")})}})},checkTelEvent:function(t){console.log(t," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:248"),t&&/^1[34578]\d{9}$/.test(t)&&e.showToast({title:"电话号码不存在",icon:"none"})},showShopCatalog:function(){e.navigateTo({url:"../category-item/category-item"})},getCatalog:function(){var t=this;e.request({url:this.$store.state.url+"Constants",data:{userId:this.$store.state.userInfo.id,owner:this.$store.state.userInfo.owner,type:39,parent:-1,objects:1},success:function(e){t.catalogList=e.data.data}})},onSelected:function(e){this.showPicker=!1,e&&(this[this.type]=e.value,"enter"==this.openType?this.shop.enterData=e.value:"open"==this.openType&&(this.shop.openDate=e.value))},onShowDatePicker:function(e,t){this.openType=t,this.type=e,this.showPicker=!0,this.value=this[e]},showMulLinkageThreePicker:function(){this.$refs.mpvueCityPicker.show()},onConfirm:function(t){var s=this,o=this;this.cityLobal=t.label,this.pickerText=JSON.stringify(t);var i=this.cityLobal.split("-"),n=i[0],r=i[1],a=i[2];this.provinceDate.forEach(function(t){t.name==n&&(s.shop.province=t.id,e.request({url:s.$store.state.url+"Districts",data:{userId:s.$store.state.userInfo.id,owner:s.$store.state.userInfo.owner,parent:t.id},success:function(t){t.data.data.forEach(function(t){t.name==r&&(o.shop.city=t.id,e.request({url:s.$store.state.url+"Districts",data:{userId:s.$store.state.userInfo.id,owner:s.$store.state.userInfo.owner,parent:t.id},success:function(e){e.data.data.forEach(function(e){e.name==a&&(o.shop.district=e.id)})}}))})}}))})},onCancel:function(e){},recordShop:function(){this.category.id&&this.shop.name&&this.shop.province&&this.shop.address?e.request({url:this.$store.state.url+"NewProprietorShop",data:{userId:this.$store.state.userInfo.id,owner:this.$store.state.userInfo.owner,catalog:this.category.id,name:this.shop.name,area:this.shop.area,address:this.shop.address,duedate:this.shop.openDate?this.shop.openDate:this.getOpenDate,summary:this.shop.summary?this.shop.summary:"",province:this.shop.province,city:this.shop.city,district:this.shop.district,telephone:this.shop.telephone,contactor:this.shop.contractor,files:this.files?this.files.join(","):"",coverurl:this.shop.coverID,status:3,type:2},success:function(t){e.showToast({title:"录入门店成功",icon:"none"}),setTimeout(function(){e.navigateTo({url:"../shop-list/shop-list"})},500)}}):e.showToast({title:"请填写完整信息",icon:"none"})},onBackPress:function(){return this.$refs.mpvuePicker.showPicker?(this.$refs.mpvuePicker.pickerCancel(),!0):this.$refs.mpvueCityPicker.showPicker?(this.$refs.mpvueCityPicker.pickerCancel(),!0):void 0},onUnload:function(){this.$refs.mpvuePicker.showPicker&&this.$refs.mpvuePicker.pickerCancel(),this.$refs.mpvueCityPicker.showPicker&&this.$refs.mpvueCityPicker.pickerCancel()},getProvince:function(){var t=this;e.request({url:this.$store.state.url+"Districts",data:{userId:this.$store.state.userInfo.id,owner:this.$store.state.userInfo.owner,parent:0},success:function(e){t.provinceDate=e.data.data}})},goBack:function(){e.navigateBack({delta:1})},ChooseImageEvent:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album"],success:function(s){console.log(s," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:453"),0!=t.imgList.length?t.imgList=t.imgList.concat(s.tempFilePaths):t.imgList=s.tempFilePaths;for(var o={params:{"x:owner":t.$store.state.userInfo.owner,"x:creator":t.$store.state.userInfo.id,"x:type":26}},i={useCdnDomain:!1},r=0;r<s.tempFilePaths.length;r++){var a=n.upload(s.tempFilePaths[r],"oaks-1"+s.tempFilePaths[r].split("/")[3]+1e5*Math.random()+".jpg",t.token,o,i);a.subscribe(function(){},function(){},function(s){t.files.push(s.data),console.log(s," at pages\\tab-item-content\\shop-center\\record-shop\\record-shop.vue:487"),t.files.length===t.imgList.length&&e.showToast({title:"上传成功",icon:"success"})})}}})},ViewImage:function(t,s){"cover"==s?e.previewImage({urls:this.coverList,current:2}):"file"==s&&e.previewImage({urls:this.imgList,current:t})},DelImg:function(t,s){var o=this;e.showModal({content:"确定删除？",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&("cover"==s?(o.coverList.splice(t,1),e.request({url:o.$store.state.url+"RemoveFiles",data:{id:o.files[t],userId:o.$store.state.userInfo.id,owner:o.$store.state.userInfo.owner},success:function(s){o.files.splice(t,1),e.showToast({title:"删除成功",icon:"none"})}})):"file"==s&&(o.imgList.splice(t,1),e.request({url:o.$store.state.url+"RemoveFiles",data:{id:o.files[t],userId:o.$store.state.userInfo.id,owner:o.$store.state.userInfo.owner},success:function(s){o.files.splice(t,1),e.showToast({title:"删除成功",icon:"none"})}})))}})},getUploadToken:function(){var t=this;e.request({url:this.$store.state.url+"UploadToken",success:function(e){t.token=e.data.data}})}}};t.default=u}).call(this,s("6e42")["default"])},"4f3c":function(e,t,s){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},i=[];s.d(t,"a",function(){return o}),s.d(t,"b",function(){return i})},"8b40":function(e,t,s){"use strict";s.r(t);var o=s("4f3c"),i=s("02a0");for(var n in i)"default"!==n&&function(e){s.d(t,e,function(){return i[e]})}(n);s("caa2");var r=s("2877"),a=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=a.exports},"8c2b":function(e,t,s){},caa2:function(e,t,s){"use strict";var o=s("8c2b"),i=s.n(o);i.a}},[["f9f7","common/runtime","common/vendor"]]]);